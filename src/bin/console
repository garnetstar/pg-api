#!/usr/bin/env php
<?php

// application.php


use Command\IndexationCommand;
use Command\MigrateCommand;
use Elasticsearch\Client;
use Elasticsearch\ClientBuilder;
use Nette\Database\Connection;
use Pimple\Container;
use Symfony\Component\Console\Application;

const APP_ROOT = __DIR__ . '/../app';

require __DIR__ . '/../vendor/autoload.php';

require __DIR__ . '/../app/container.php';


//
//$container = new Container();
//
//$container['database'] = function($c) {
//	$database = new Connection('mysql:host=db;dbname=' . getenv('DB_NAME'), 'root', getenv('DB_PASSWORD'));
//	return $database;
//};
//
//$container[Client::class] = function($c) {
//	$hosts = [
//	'elastic1:9200', // IP + Port
//	];
//	$clientBuilder = ClientBuilder::create();   // Instantiate a new ClientBuilder
//	$clientBuilder->setHosts($hosts);		   // Set the hosts
//	$client = $clientBuilder->build();
//	return $client;
//};

//$container[IndexationCommand::class] = function($c) {
//	return new IndexationCommand($c[Client::class],$c['database']);
//};

$application = new Application();

$application->add($container[MigrateCommand::class]);

$application->run();

